<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GestÃ£o de MTRs</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="mtr.css">
</head>
<body>

<main>

    <!-- CabeÃ§alho -->
    <header class="header">
        <a href="adm/gestao.html" class="logo-link">
            <img src="../../img/icone.png" alt="Logo Manserv" class="logo">
        </a>
        <h1>GestÃ£o de MTRs</h1>
    </header>

    <!-- NavegaÃ§Ã£o -->
    <nav>
        <div class="nav-tabs">
            <button class="nav-tab active" onclick="mudarMenu(0, this)">ðŸ“¥ Entrada</button>
            <button class="nav-tab" onclick="mudarMenu(1, this)">ðŸ“¤ Entrega</button>
            <button class="nav-tab" onclick="mudarMenu(2, this)">ðŸ“‹ HistÃ³rico</button>
        </div>
    </nav>

    <!-- ====== MENU 1: ENTRADA DE MTRs ====== -->
    <div id="menu-0" class="page active">
        <section>
            <h2>Registrar MTRs Recebidas</h2>

            <div id="mtrBlocksContainer">
                <!-- Bloco inicial -->
                <div class="mtr-block" data-index="1">
                    <div class="mtr-block-header">
                        <span class="mtr-block-title">MTR #1</span>
                    </div>
                    <label>Data de EmissÃ£o:
                        <input type="date" class="campo-data">
                    </label>
                    <label>CÃ³digo da MTR:
                        <input type="text" class="campo-codigo" maxlength="10" placeholder="10 dÃ­gitos">
                    </label>
                    <div class="field-error codigo-error" style="display:none;">âš  O cÃ³digo deve ter exatamente 10 dÃ­gitos.</div>
                    <label>Tipo:
                        <select class="campo-tipo">
                            <option value="">Selecione:</option>
                            <option value="Infectante/Perfuro">Infectante/Perfuro</option>
                            <option value="QuÃ­mico">QuÃ­mico</option>
                            <option value="PapelÃ£o">PapelÃ£o</option>
                            <option value="PlÃ¡stico">PlÃ¡stico</option>
                        </select>
                    </label>
                </div>
            </div>

            <button class="btn-add" id="btnAddMTR" onclick="adicionarBlocoMTR()">
                + Adicionar MTR
            </button>

            <div class="btn-row">
                <button class="btn-primary" onclick="salvarMTRs()">ðŸ’¾ Salvar Entradas</button>
            </div>
        </section>
    </div>

    <!-- ====== MENU 2: ENTREGA DE MTRs ====== -->
    <div id="menu-1" class="page">
        <section>
            <h2>Selecione uma ou mais MTRs e clique em "Confirmar Entrega</h2>

            <div id="mtrEntregaList" class="mtr-list">
                <p class="msg-loading">Carregando MTRs em posse...</p>
            </div>

            <div class="btn-row" style="margin-top:20px;">
                <button class="btn-secondary" onclick="desmarcarTodos()">Desmarcar Todos</button>
                <button class="btn-primary" onclick="abrirModalEntrega()">âœ” Confirmar Entrega</button>
            </div>
        </section>
    </div>

    <!-- ====== MENU 3: HISTÃ“RICO ====== -->
    <div id="menu-2" class="page">
        <section>
            <h2>HistÃ³rico de MTRs</h2>

            <div class="filtros">
                <input type="text" id="filtroHistCodigo" placeholder="CÃ³digo MTR...">
                <select id="filtroHistTipo">
                    <option value="">Todos os tipos</option>
                    <option value="Infectante/Perfuro">Infectante/Perfuro</option>
                    <option value="QuÃ­mico">QuÃ­mico</option>
                    <option value="PapelÃ£o">PapelÃ£o</option>
                    <option value="PlÃ¡stico">PlÃ¡stico</option>
                </select>
                <select id="filtroHistStatus">
                    <option value="">Todos os status</option>
                    <option value="Em Posse">Em Posse</option>
                    <option value="Entregue">Entregue</option>
                </select>
                <button onclick="filtrarHistorico()">Filtrar</button>
            </div>

            <div class="table-container">
                <table id="tabelaHistorico">
                    <thead>
                        <tr>
                            <th>CÃ³digo</th>
                            <th>Tipo</th>
                            <th>Dt. EmissÃ£o</th>
                            <th>Dt. Entrega</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td colspan="5" class="msg-loading">Carregando histÃ³rico...</td></tr>
                    </tbody>
                </table>
            </div>
        </section>
    </div>

</main>

<!-- ====== MODAL DE CONFIRMAÃ‡ÃƒO ====== -->
<div class="modal-overlay" id="modalOverlay">
    <div class="modal">
        <h3>Confirmar entrega das seguintes MTRs?</h3>
        <div class="modal-list" id="modalLista"></div>
        <div class="modal-btns">
            <button class="btn-secondary" onclick="fecharModal()">âœ— NÃ£o</button>
            <button class="btn-primary" onclick="confirmarEntrega()">âœ” Sim</button>
        </div>
    </div>
</div>

<!-- ====== TOAST ====== -->
<div class="toast" id="toast"></div>

<footer class="footer">
    <p>Â© 2025 <strong>Manserv - Equipe HSANA</strong>. Todos os direitos reservados.</p>
</footer>

<script src="mtr.js"></script>
</body>
</html>